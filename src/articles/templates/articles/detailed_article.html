{% extends 'base.html' %}

{% block title %}
{{ article.title }}
{% endblock title %}

{% block content %}
<a href="{% url 'articles:all-articles' news_paper_id=newspaper.id %}" class="back-link">← Zurück zur Artikelübersicht</a>
<div class="styled-article-container">
  <!-- Header mit Bild, Titel und Metadaten -->
  <div class="article-header">
    <div class="article-image">
      <img src="{{ article.image.url }}" alt="{{ article.title }}" />
    </div>
    <h1 class="article-title">{{ article.title }}</h1>
    <p class="article-meta">Published on: {{ article.created_at|date:"F j, Y" }}</p>
  </div>

  <!-- Hauptinhalt des Artikels -->
  <div class="article-content">
    <p>{{ article.content|linebreaks }}</p>
  </div>

  <!-- Footer mit Zurück-Button -->
  <div class="ui center aligned container">
    {% comment %} <a href="{% url 'articles:all-articles' news_paper_id=newspaper.id %}" class="ui secondary basic button" >Back to all articles</a> {% endcomment %}
    <a href="{% url 'comments:article-comments' news_paper_id=newspaper.id article_id=article.id %}"
    class="ui right labeled icon button">
    <i class="right arrow icon"></i>
        Kommentare ansehen ({{ public_comments_count }})
    </a>
  </div>
</div>
{% endblock content %}

{% comment %} LOG ENTRY {% endcomment %}
<script>
    let startTime = Date.now();

    window.addEventListener("beforeunload", function() {
        let duration = Date.now() - startTime;  // Zeit in Millisekunden

        fetch("{% url 'analytics:log_time_spent' %}", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-CSRFToken": "{{ csrf_token }}"
            },
            body: JSON.stringify({
                page_type: "detailed_article",
                id: {{ article.id }},
                duration_ms: duration
            })
        });
    });
</script>


